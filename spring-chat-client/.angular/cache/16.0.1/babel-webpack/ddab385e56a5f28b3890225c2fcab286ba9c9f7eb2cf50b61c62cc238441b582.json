{"ast":null,"code":"import { filter, map } from 'rxjs/operators';\nimport { NewChatComponent } from './new-chat/new-chat.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@nebular/theme\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/_services/user.service\";\nimport * as i4 from \"src/app/_services/chat.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../shared/directives/img-fallback.directive\";\nfunction ChatListComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"div\", 4);\n    i0.ɵɵelement(2, \"img\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 6)(4, \"h6\", 7);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 4);\n    i0.ɵɵelement(7, \"nb-icon\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r0.profile.imgUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.profile.userName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"nbContextMenu\", ctx_r0.menu);\n  }\n}\nfunction ChatListComponent_nb_list_item_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nb-list-item\", 9);\n    i0.ɵɵlistener(\"click\", function ChatListComponent_nb_list_item_6_Template_nb_list_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const friend_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.chatClicked(friend_r2.id));\n    });\n    i0.ɵɵelement(1, \"nb-user\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const friend_r2 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"name\", friend_r2.userName)(\"title\", friend_r2.lastMsg)(\"picture\", friend_r2.imgUrl);\n  }\n}\nlet ChatListComponent = /*#__PURE__*/(() => {\n  class ChatListComponent {\n    constructor(menuService, router, dialogService, userService, chatService, route) {\n      this.menuService = menuService;\n      this.router = router;\n      this.dialogService = dialogService;\n      this.userService = userService;\n      this.chatService = chatService;\n      this.route = route;\n      this.menu = [{\n        title: 'Profile',\n        icon: 'person-outline'\n      }, {\n        title: 'New Chat',\n        icon: 'person-add-outline'\n      }, {\n        title: 'New Group',\n        icon: 'plus-outline'\n      }, {\n        title: 'Settings',\n        icon: 'settings-outline'\n      }, {\n        title: 'Log out',\n        icon: 'unlock-outline'\n      }];\n      this.profile = this.userService.getProfile();\n      this.friends = this.chatService.getFriends();\n    }\n    ngOnInit() {\n      this.menuListener();\n    }\n    menuListener() {\n      this.menuService.onItemClick().pipe(filter(({\n        tag\n      }) => tag === 'context-chat-more'), map(({\n        item: {\n          title\n        }\n      }) => title)).subscribe(title => {\n        switch (title) {\n          case 'Profile':\n            this.router.navigateByUrl(\"/profile\");\n            break;\n          case 'New Chat':\n            this.dialogService.open(NewChatComponent).onClose.subscribe(userName => {\n              this.chatService.createFriend(userName).subscribe(r => {\n                console.log(r);\n              }, err => {\n                console.log(err);\n              });\n            });\n            break;\n          case 'New Group':\n            break;\n          case 'Settings':\n            this.router.navigateByUrl(\"/settings\");\n            break;\n          case 'Log out':\n            this.userService.logout();\n            this.router.navigateByUrl(\"/auth\");\n            break;\n          default:\n            break;\n        }\n      });\n    }\n    chatClicked(id) {\n      this.router.navigate([id], {\n        relativeTo: this.route,\n        skipLocationChange: true\n      });\n    }\n  }\n  ChatListComponent.ɵfac = function ChatListComponent_Factory(t) {\n    return new (t || ChatListComponent)(i0.ɵɵdirectiveInject(i1.NbMenuService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i1.NbDialogService), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.ChatService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n  };\n  ChatListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChatListComponent,\n    selectors: [[\"home-chat-list\"]],\n    decls: 8,\n    vars: 4,\n    consts: [[\"class\", \"row no-gutters align-items-center\", 4, \"ngIf\"], [\"nbInput\", \"\", \"fullWidth\", \"\", \"name\", \"search\", \"placeholder\", \"Search\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"row\", \"no-gutters\", \"align-items-center\"], [1, \"col-auto\"], [\"width\", \"50px\", \"appImgFallback\", \"\", 1, \"img-fluid\", \"rounded-circle\", 3, \"src\"], [1, \"col\"], [1, \"pl-3\", \"pr-3\"], [\"icon\", \"more-vertical-outline\", \"nbContextMenuPlacement\", \"left\", \"nbContextMenuTag\", \"context-chat-more\", 3, \"nbContextMenu\"], [3, \"click\"], [3, \"name\", \"title\", \"picture\"]],\n    template: function ChatListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"nb-card\")(1, \"nb-card-header\");\n        i0.ɵɵtemplate(2, ChatListComponent_div_2_Template, 8, 3, \"div\", 0);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"nb-card-body\");\n        i0.ɵɵelement(4, \"input\", 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"nb-list\");\n        i0.ɵɵtemplate(6, ChatListComponent_nb_list_item_6_Template, 2, 3, \"nb-list-item\", 2);\n        i0.ɵɵpipe(7, \"async\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.profile);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(7, 2, ctx.friends));\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i1.NbCardComponent, i1.NbCardBodyComponent, i1.NbCardHeaderComponent, i1.NbInputDirective, i1.NbIconComponent, i1.NbUserComponent, i1.NbListComponent, i1.NbListItemComponent, i1.NbContextMenuDirective, i6.ImgFallbackDirective, i5.AsyncPipe],\n    styles: [\"nb-card[_ngcontent-%COMP%]{padding:0!important;height:100%}nb-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:unset}nb-card[_ngcontent-%COMP%]   nb-list[_ngcontent-%COMP%]{height:60vh}nb-card[_ngcontent-%COMP%]   nb-list[_ngcontent-%COMP%]   nb-list-item[_ngcontent-%COMP%]:hover{background-color:#4c4c4c09;cursor:pointer}\"]\n  });\n  return ChatListComponent;\n})();\nexport { ChatListComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}