{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { DialogAuthenticationFailureComponent } from \"../../shared/dialog/dialog-alert/dialog-authentication-failure.component\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/_services/chat.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/_services/user.service\";\nimport * as i4 from \"@nebular/theme\";\nimport * as i5 from \"../../_services/token-storage.service\";\nimport * as i6 from \"../../_services/data.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/progress-bar\";\nconst _c0 = function (a0) {\n  return {\n    \"left\": a0\n  };\n};\nlet LoadingComponent = /*#__PURE__*/(() => {\n  class LoadingComponent {\n    constructor(chatService, router, userService, dialogService, tokenStorageService, dataService) {\n      this.chatService = chatService;\n      this.router = router;\n      this.userService = userService;\n      this.dialogService = dialogService;\n      this.tokenStorageService = tokenStorageService;\n      this.dataService = dataService;\n      this.progress = 0;\n    }\n    ngOnInit() {\n      this.progress = 10;\n      this.chatService.updateFetch(10);\n      this.userService.fetchProfile().subscribe({\n        complete: () => {\n          this.progress = 20;\n          this.chatService.updateFetch(20);\n        },\n        error: e => {\n          this.errorFetch(e);\n        }\n      });\n      this.chatService.fetchFriends().subscribe({\n        complete: () => {\n          this.progress = 80;\n          this.chatService.updateFetch(80);\n        },\n        next: friends => {\n          (() => __awaiter(this, void 0, void 0, function* () {\n            if (friends.length != 0) {\n              this.chatService.fetchMessages(friends[0].id).subscribe({\n                error: e => {\n                  this.errorFetch(e);\n                }\n              });\n            }\n            this.progress = 100;\n            this.chatService.updateFetch(100);\n          }))();\n        },\n        error: e => {\n          this.errorFetch(e);\n        }\n      });\n    }\n    errorFetch(e) {\n      if (e.status === 401) {\n        this.dialogService.open(DialogAuthenticationFailureComponent, {\n          context: {\n            title: \"Authentication\",\n            message: 'Session Time Out'\n          }\n        }).onClose.subscribe(() => {\n          this.tokenStorageService.signOut();\n          window.location.reload();\n        });\n      } else {\n        console.log(e);\n      }\n    }\n  }\n  LoadingComponent.ɵfac = function LoadingComponent_Factory(t) {\n    return new (t || LoadingComponent)(i0.ɵɵdirectiveInject(i1.ChatService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.NbDialogService), i0.ɵɵdirectiveInject(i5.TokenStorageService), i0.ɵɵdirectiveInject(i6.DataService));\n  };\n  LoadingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoadingComponent,\n    selectors: [[\"app-loading\"]],\n    decls: 15,\n    vars: 5,\n    consts: [[1, \"container\", \"h-100\"], [1, \"row\", \"h-100\", \"justify-content-center\", \"align-items-center\"], [1, \"col-lg-6\", \"col-md-8\", \"col-sm-10\", \"col-12\"], [1, \"text-center\"], [\"role\", \"status\", 1, \"spinner-border\", \"text-basic\", \"m-5\"], [\"mode\", \"determinate\", 3, \"value\"], [2, \"position\", \"absolute\", \"top\", \"0.5em\", 3, \"ngStyle\"]],\n    template: function LoadingComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"nb-card\", 3)(4, \"nb-card-header\")(5, \"h2\");\n        i0.ɵɵtext(6, \"Friends Chat\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"nb-card-body\");\n        i0.ɵɵelement(8, \"div\", 4)(9, \"mat-progress-bar\", 5);\n        i0.ɵɵelementStart(10, \"span\", 6);\n        i0.ɵɵtext(11);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"nb-card-footer\")(13, \"h6\");\n        i0.ɵɵtext(14, \"Powered By: Deepanshu Tyagi (Bang pt -God of Copy)\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"value\", ctx.progress);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(3, _c0, ctx.progress + \"%\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\"\", ctx.progress, \"%\");\n      }\n    },\n    dependencies: [i7.NgStyle, i4.NbCardComponent, i4.NbCardBodyComponent, i4.NbCardFooterComponent, i4.NbCardHeaderComponent, i8.MatProgressBar],\n    styles: [\"mat-progress-bar[_ngcontent-%COMP%]{height:2em}\"]\n  });\n  return LoadingComponent;\n})();\nexport { LoadingComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}